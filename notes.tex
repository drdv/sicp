\documentclass[12pt,a4paper]{article}

% ================================================================================

\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\minimize}[1]{\mathop{\mbox{minimize}}_{#1} \ \ }
\newcommand{\maximize}[1]{\mathop{\mbox{maximize}}_{#1} \ \ }
\newcommand{\st}[0]{\mbox{subject to} \ \ }
\newcommand\cc[1]{\texttt{#1}}
\newcommand{\abs}[1]{\left|#1\right|}

% ================================================================================

\usepackage{array}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage[sans]{dsfont}
\usepackage{bbm}
\usepackage{amsmath,bm}
\usepackage{url}
\usepackage{hyperref}
\usepackage{eurosym}
\usepackage{bbold}
\usepackage[toc,page]{appendix}
\usepackage[top=2cm, bottom=2cm, left=2cm, right=2cm]{geometry}

\def\UrlBreaks{\do\/\do-}  % https://tex.stackexchange.com/a/561193

\usepackage[toc,page]{appendix}

\usepackage[breakable]{tcolorbox}
\DeclareRobustCommand{\mybox}[2][gray!20]{
  \begin{tcolorbox}[
      breakable,
      left=0pt,
      right=0pt,
      top=0pt,
      bottom=0pt,
      colback=#1,
      colframe=#1,
      width=\dimexpr\textwidth\relax,
      enlarge left by=0mm,
      boxsep=5pt,
      arc=0pt,outer arc=0pt,
    ]
    #2
  \end{tcolorbox}
}

\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}

\begin{document}

\section{Exercise 1.13}

\subsection{Proof 1}

The second-order difference equation $F_k = F_{k-1} + F_{k-2}$ can be represented as two
first-order equations
\begin{align*}
  \underbrace{\begin{bmatrix} F_{k-1} \\ F_k \end{bmatrix}}_{x_{k+1}} =
  \underbrace{\begin{bmatrix} 0 & 1 \\ 1 & 1 \end{bmatrix}}_{A}
  \underbrace{\begin{bmatrix} F_{k-2} \\ F_{k-1} \end{bmatrix}}_{x_k}.
\end{align*}
Hence, $x_{n}$ (where $n \geq 2$) depends on the initial condition $x_0 = (F_0, F_1) = (0, 1)$ as follows
\begin{align} \label{eq.initial-condition}
  x_n = A^nx_0.
\end{align}
The eigenvalues of $A$ are~\footnote{We have to find $\lambda$ such that $\cc{det}(A - \lambda I) = 0$.}
\begin{align*}
  \lambda_1 = \frac{1 + \sqrt{5}}{2}, \quad \lambda_2 = \frac{1 - \sqrt{5}}{2},
\end{align*}
with corresponding eigenvectors~\footnote{Found by solving equations $(A - \lambda_i
I)q_i = 0$ (and normalizing).}
\begin{align*}
  q_1 = \frac{1}{n_1}\begin{bmatrix} 1 \\ \lambda_1 \end{bmatrix}, \quad
  q_2 = \frac{1}{n_2}\begin{bmatrix} 1 \\ \lambda_2 \end{bmatrix},
\end{align*}
where $n_k = \norm{q_k} = \sqrt{1 + \lambda_k^2}$. Using
\begin{align*}
  Q = \begin{bmatrix}q1 & q2\end{bmatrix}, \quad
    \Lambda = \begin{bmatrix} \lambda_1 & 0 \\ 0 & \lambda_2 \end{bmatrix}
\end{align*}
we can perform a similarity transform (note that $Q$ is an orthogonal matrix)
\begin{align*}
  x_{k+1} = \underbrace{Q\Lambda Q^T}_{A} x_k,
\end{align*}
Hence, we can express~\eqref{eq.initial-condition} as (note that $(Q\Lambda Q^T)(Q\Lambda Q^T) = (Q\Lambda^2 Q^T)$)
\begin{align*}
  x_{n}
  = Q\Lambda^n \underbrace{Q^T x_0}_{\tilde{x}_0}
  = \frac{\lambda_1}{n_1}q_1\lambda_1^n + \frac{\lambda_2}{n_2}q_2\lambda_2^n,
\end{align*}
where $\tilde{x}_0 = (\lambda_1/n_1, \lambda_2/n_2)$ can be seen as the initial
conditions after the similarity transform. Therefore, we can express the $n$-th
Fibonacci number as the first component of $x_{n}$
\begin{align*}
  F_n
  &= \frac{\lambda_1}{n_1^2}\lambda_1^n + \frac{\lambda_2}{n_2^2}\lambda_2^n \\
  &= \frac{1 + \sqrt{5}}{5 + \sqrt{5}}\lambda_1^n + \frac{1 - \sqrt{5}}{5 - \sqrt{5}}\lambda_2^n
  = \frac{\sqrt{5}\lambda_1^n - \sqrt{5}\lambda_2^n}{5} \\
  &= \frac{\lambda_1^n - \lambda_2^n}{\sqrt{5}}.
\end{align*}

Note that $|\lambda_2^n| < 1$ for any $n > 0$ and hence, dividing by $\sqrt{5} > 2$
leads to a number smaller than $1/2$. Therefore, $F_n$ is the closest integer to
$\lambda_1^n / \sqrt{5}$.

\subsection{Proof 2 (by induction)}

\begin{itemize}
\item for $n = 0$ we have $F_0 = \frac{\lambda_1^{0} - \lambda_2^{0}}{\sqrt{5}} = 0$
\item for $n = 1$ we have $F_1 = \frac{\lambda_1^{1} - \lambda_2^{1}}{\sqrt{5}} = 1$
\item next, assume that $F_{n-2} = \frac{\lambda_1^{n-2} - \lambda_2^{n-2}}{\sqrt{5}}$
  and $F_{n-1} = \frac{\lambda_1^{n-1} - \lambda_2^{n-1}}{\sqrt{5}}$, we have to prove
  that $F_{n} = F_{n-1} + F_{n-2} = \frac{\lambda_1^{n} - \lambda_2^{n}}{\sqrt{5}}$:
\end{itemize}
\begin{align*}
  \lambda_1^{n-2} - \lambda_2^{n-2} + \lambda_1^{n-1} - \lambda_2^{n-1}
  &= \lambda_1^{n-2} + \lambda_1^{n-1} - (\lambda_2^{n-2} + \lambda_2^{n-1}) \\
  &= \lambda_1^n\lambda_1^{-1}\underbrace{(\lambda_1^{-1} + 1)}_{\lambda_1} - \lambda_2^n\lambda_2^{-1}\underbrace{(\lambda_2^{-1} + 1)}_{\lambda_2} \\
  &= \lambda_1^n - \lambda_2^n,
\end{align*}
where we have used that $\lambda_i - \frac{1}{\lambda_i} = 1$ (for $i=1,2$). This is the
case because $\lambda_1$ and $\lambda_2$ are eigenvalues of $A$
(see~\eqref{eq.initial-condition}) and hence they satisfy its characteristic equation
$\cc{det}(A - \lambda I) = 0$ (\emph{i.e.,} $\lambda^2 - \lambda -1 = 0$).

\section{Exercise 1.19}

Transformation:
\begin{align*}
  a &\leftarrow bq + a(p + q) \\
  b &\leftarrow bp + aq.
\end{align*}
Applying twice:
\begin{align*}
  a
  &\leftarrow (bp + aq)q + (bq + ap + aq)p + (bq + ap + aq)q \\
  &\leftarrow bpq + aq^2 + bpq + ap^2 + apq + bq^2 + apq + aq^2 \\
  &\leftarrow bpq + bpq + bq^2 + aq^2  + ap^2 + apq + apq + aq^2 \\
  &\leftarrow b(q^2 + 2pq) + a(p^2 + 2pq + 2q^2) \\
  %
  b
  &\leftarrow (bp + aq)p + (bq + ap + aq)q \\
  &\leftarrow bp^2 + apq + bq^2 + apq + aq^2 \\
  &\leftarrow b(p^2 + q^2) + a(q^2 + 2pq).
\end{align*}
Hence
\begin{align*}
  p^{'} &= p^2 + q^2 \\
  q^{'} &= q^2 + 2pq.
\end{align*}

\section{Exercise 1.24}

In this exercise we use the first two properties of the $\bmod$ operator (for integers
$x$, $y$ and $n$)
\begin{align}
  (xy)\bmod n &= [(x\bmod n)(y\bmod n)]\bmod n \label{eq.mod.property1} \\
  (xy)\bmod n &= [x(y\bmod n)]\bmod n \label{eq.mod.property2} \\
  (x + y)\bmod n &= [(x\bmod n) + (y\bmod n)]\bmod n \label{eq.mod.property3}
\end{align}
Lets prove them.

\subsection{Proof of property~\eqref{eq.mod.property3}}

We can express
\begin{align} \label{eq.quotient-form}
  \begin{split}
    x &= q_xn + (x \bmod n) \\
    y &= q_yn + (y \bmod n),
  \end{split}
\end{align}
for some integers $q_x$ and $q_y$. Substituting these in $(x + y) \bmod n$ gives
\begin{align*}
  \left[\underbrace{(q_x + q_y)}_{q}n + \underbrace{(x \bmod n) + (y \bmod n)}_z\right] \bmod n = (qn + z) \bmod n.
\end{align*}
By definition
\begin{align*}
  u \bmod n = u - n\floor{\frac{u}{n}},
\end{align*}
hence (note that $q$ is an integer)
\begin{align*}
  (qn + z) \bmod n
  &= (qn + z) - n\floor{\frac{qn + z}{n}} \\
  &= (qn + z) - n\floor{q + \frac{z}{n}} \\
  &= (qn + z) - n\left(q + \floor{\frac{z}{n}}\right) \\
  &= (qn + z) - \left(qn + n\floor{\frac{z}{n}}\right) \\
  &= z - n\floor{\frac{z}{n}} \\
  &= z\bmod n.
\end{align*}
Therefore we have proven~\eqref{eq.mod.property3}.

\subsection{Proof of property~\eqref{eq.mod.property1}}

Substituting~\eqref{eq.quotient-form} in $(xy)\bmod n$ gives
\begin{align*}
  (q_xq_yn^2 + q_xn(y \bmod n) + q_yn(x \bmod n) + (x \bmod n)(y \bmod n))\bmod n
\end{align*}
Using property~\eqref{eq.mod.property3} we see that $(xy)\bmod n = ((x \bmod n)(y \bmod n))\bmod n$ because
\begin{align*}
  q_xq_yn^2\bmod n = q_xn(y \bmod n)\bmod n = q_yn(x \bmod n)\bmod n = 0.
\end{align*}

\subsection{Proof of property~\eqref{eq.mod.property2}}

Using property~\eqref{eq.mod.property1} to expand $[x(y\bmod n)]\bmod n$ we get
\begin{align*}
  [x(y\bmod n)]\bmod n
  &= [(x\bmod n)((y\bmod n)\bmod n)]\bmod n \\
  &= [(x\bmod n)(y\bmod n)]\bmod n \\
  &= (xy)\bmod n.
\end{align*}

\section{Exercise 1.28}

If $x^2 \bmod n = m \bmod n$~\footnote{Which could be written equivalently as $x^2
\equiv m \bmod n$.} we say that $x$ is the square root of $m$ modulo $n$. For example,
\begin{align*}
  1^2 \equiv 3^2 \equiv 5^2 \equiv 7^2 \equiv 1 \bmod 8,
\end{align*}
that is $1, 3, 5$ and $7$ are square roots of $1$ modulo $n=8$~\footnote{\emph{i.e.,}
$x^2 \equiv 1 \bmod n$ implies $x^2 = kn + 1$ (with a positive integer $k$).}. We are
interested in the case when $m = 1$. We consider $1$ and $n-1$ as trivial square roots
of $1$ modulo $n$ because
\begin{itemize}
\item $1^2 \bmod n = 1 \bmod n = 1$
\item $(n-1)^2 \bmod n = (n^2 - 2n + 1) \bmod n = 1$, using property~\eqref{eq.mod.property3}.
\end{itemize}
Of course, we could say the same thing about $n+1$ but in the Miller-Rabin test we care
only about numbers smaller than $n$.

\section{Exercise 2.13}

Let $x$ represent an interval. We use the following notation:
\begin{itemize}
\item $x_c$: the center of interval $x$
\item $x_w$: the width of interval $x$
\item $x_{\ell} = x_c - x_w$: interval lower-bound
\item $x_{u} = x_c + x_w$: interval upper-bound
\item $x_p = 100\frac{x_w}{x_c}$: what percent of $x_c$ is $x_w$.
\end{itemize}
We have to find a simplified expression for $z_p$ in terms of $x_p$ and $y_p$, where
$x$, $y$ and $z$ are intervals such that $z = x * y$~\footnote{The operator $*$ denotes
multiplication of intervals.}. In this exercise we are allowed to assume that $x_{\ell},
y_{\ell} \geq 0$ (see ``case 1'' in exercise 2.11 in \cc{exercises2.rkt}) - this implies
that:
\begin{itemize}
\item $z_{\ell} = x_{\ell} y_{\ell} = (x_c - x_w)(y_c - y_w) = x_cy_c - x_cy_w - x_wy_c + x_wy_w$
\item $z_{u} = x_{u} y_{u} = (x_c + x_w)(y_c + y_w) = x_cy_c + x_cy_w + x_wy_c + x_wy_w$
\item $z_w = \frac{1}{2}(z_u - z_{\ell}) = x_cy_w + x_wy_c$
\item $z_c = \frac{1}{2}(z_u + z_{\ell}) = x_cy_c + x_wy_w$
\item $z_p = 100\frac{z_w}{z_c} = 100\frac{x_cy_w + x_wy_c}{x_cy_c + x_wy_w} \approx 100\frac{x_cy_w + x_wy_c}{x_cy_c}$ because $x_w$ and $y_w$ are assumed small.
\end{itemize}
The expression for $z_p$ can be further reduced to $z_p = x_p + y_p$ by expressing $x_w$ and $y_w$ in terms of $x_p$ and $y_p$.

\appendix
\appendixpage

\section{Random quotes}

\begin{itemize}
\item It is very easy to confuse the essence of what you are doing with the tools that
  you use.
\item One of the things we have to learn how to do is ignore details. The key to
  understand complicated things is to know what not to look at.
\item The way in which you would construct a recursive process is by wishful thinking.
  You have to believe~\footnote{He is talking about the Hanoi towers problem.}.
\item Wishful thinking - essential to good engineering, and certainly essential to good
  computer-science.
\end{itemize}

\nocite{*}
\bibliographystyle{ieeetr}
\bibliography{bib}

\end{document}
